在unity中，矩阵主要用于变换计算，包括位置、旋转和缩放。

**相机变换**（计算视图和投影矩阵，以将世界坐标转换到屏幕坐标）

**骨骼动画**（使用矩阵将关节变换应用到网格顶点）



### 矩阵的基本概念

1. 定义：矩阵是一个二维数组，通常用于线性代数运算
2. 用途：在计算机图形学中，矩阵用于表示和计算变换（平移、旋转、缩放）
3. 类型：常用的矩阵类型`Matrix4x4`，它是一个4x4的矩阵

`Matrix4x4`包含16个元素，排列在一个4x4的网格中。每个元素都可以通过索引访问

```
Matrix4x4 matrix = new Matrix4x4();
Matrix4x4 identity = Matrix4x4.identity;  // 单位矩阵
```

- 变换矩阵

- - 平移矩阵：

    ```
    Matrix4x4 translation = Matrix4x4.Translate(new Vector3(x, y, z));
    ```

    

  - 旋转矩阵：

    - 绕X轴旋转

      ```
      Matrix4x4 rotationX = Matrix4x4.Rotate(Quaternion.Euler(angleX, 0, 0));
      ```

      

    - 绕Y轴旋转

      ```
      Matrix4x4 rotationY = Matrix4x4.Rotate(Quaternion.Euler(0, angleY, 0));
      ```

      

    - 绕Z轴旋转

      ```
      Matrix4x4 rotationZ = Matrix4x4.Rotate(Quaternion.Euler(0, 0, angleZ));
      ```

      

  - 缩放矩阵：

    ```
    Matrix4x4 scale = Matrix4x4.Scale(new Vector3(scaleX, scaleY, scaleZ));
    ```

### 矩阵的运算

1. 矩阵和矩阵之间的基本运算

   - 矩阵加法和减法

     - 定义：两个矩阵可以相加或者相减，但必须具有相同的维度

     - 运算规则：

       - **加法**: 对于矩阵`A`和`B`，`C[i][j] = A[i][j] + B[i][j]`

       - **减法**: 对于矩阵`A`和`B`，`C[i][j] = A[i][j] - B[i][j]`

         ```
         using UnityEngine;
         
         public class MatrixAddSubtract : MonoBehaviour
         {
             void Start()
             {
                 Matrix4x4 A = new Matrix4x4(
                     new Vector4(1, 2, 3, 4),
                     new Vector4(5, 6, 7, 8),
                     new Vector4(9, 10, 11, 12),
                     new Vector4(13, 14, 15, 16));
         
                 Matrix4x4 B = new Matrix4x4(
                     new Vector4(0, 1, 2, 3),
                     new Vector4(4, 5, 6, 7),
                     new Vector4(8, 9, 10, 11),
                     new Vector4(12, 13, 14, 15));
         
                 // 矩阵加法
                 Matrix4x4 C = A + B;
                 
                 // 矩阵减法
                 Matrix4x4 D = A - B;
         
                 Debug.Log("Result of A + B: " + C);
                 Debug.Log("Result of A - B: " + D);
             }
         }
         ```

         

   - 矩阵乘法

     - 定义：矩阵乘法用于组合变换，如旋转和平移的组合

     - 运算法则：

       - 若`A`是`m x n`矩阵，`B`是`n x p`矩阵，则`C`是`m x p`矩阵

       - 计算：`C[i][j] = Σ(A[i][k] * B[k][j])`

         ```
         using UnityEngine;
         
         public class MatrixMultiplication : MonoBehaviour
         {
             void Start()
             {
                 // 创建一个平移矩阵，将对象沿x轴平移3个单位
                 Matrix4x4 translationMatrix = Matrix4x4.Translate(new Vector3(3, 0, 0));
                 
                 // 创建一个缩放矩阵，将对象沿各个轴缩放2倍
                 Matrix4x4 scaleMatrix = Matrix4x4.Scale(new Vector3(2, 2, 2));
         
                 // 使用矩阵乘法组合变换（先进行缩放，再进行平移）
                 Matrix4x4 combinedMatrix = translationMatrix * scaleMatrix;
         
                 // 创建一个向量，表示初始位置
                 Vector3 initialPosition = new Vector3(1, 1, 1);
         
                 // 应用组合的矩阵到向量，得到变换后的位置
                 Vector3 transformedPosition = combinedMatrix.MultiplyPoint(initialPosition);
         
                 Debug.Log("Transformed Position: " + transformedPosition);
             }
         }
         ```

         

   

2. 矩阵和标量的运算

   - **定义**: 与矩阵的每个元素相乘。

   - **运算规则**: `B[i][j] = k * A[i][j]`

     ```
     using UnityEngine;
     
     public class MatrixScalar : MonoBehaviour
     {
         void Start()
         {
             float k = 2.0f; // 标量
             Matrix4x4 A = new Matrix4x4(
                 new Vector4(1, 2, 3, 4),
                 new Vector4(5, 6, 7, 8),
                 new Vector4(9, 10, 11, 12),
                 new Vector4(13, 14, 15, 16));
     
             // 矩阵和标量相乘
             Matrix4x4 B = A * k; 
     
             Debug.Log("Result of A * k: " + B);
         }
     }
     ```

     

3. 矩阵和向量的运算

   - **定义**: 用于空间变换。

   - **运算规则**: `u = M * v`

     ```
     using UnityEngine;
     
     public class MatrixVector : MonoBehaviour
     {
         void Start()
         {
             Matrix4x4 matrix = Matrix4x4.Rotate(Quaternion.Euler(45, 30, 60)); // 旋转矩阵
             Vector3 originalVector = new Vector3(1, 1, 1);
             
             // 应用旋转到向量
             Vector3 transformedVector = matrix.MultiplyPoint(originalVector); 
     
             Debug.Log("Transformed Vector: " + transformedVector);
         }
     }
     ```

     



### 矩阵的逆和转置







